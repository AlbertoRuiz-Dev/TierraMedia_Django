{% extends 'base.html' %}
{% block title %}Batalla / Tierra Media{% endblock %}
{% load static %}

{% block links %}
    <script src="{% static 'js/battle.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="container text-center rounded w-25 mt-3" style="display: {% if char1 and char2 %}none{% else %}block{% endif %};">
        <h2>Selecciona los personajes para la batalla.</h2>
        <form method="post" id="battle_form" action="{% url 'juego:battleView' %}">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" id="start_battle" class="btn btn-primary">¡Batalla!</button>
        </form>
        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
    </div>

    <div class="container-fluid text-center rounded mt-3" id="battle_arena" style="display: {% if char1 and char2 %}block{% else %}none{% endif %};">
        <h2>¡Batalla en curso!</h2>
        <p id="status"></p>

        <div>
            <h3 id="char1_name">{{ char1.name }}</h3>
            <p>HP: <span id="char1_hp">100</span></p>
            <input type="hidden" id="char1_id" value="{{ char1.id }}">

            <div id="char1_controls">
                <button type="button" id="char1_fuerte" class="btn btn-primary">⚔️ Ataque Fuerte</button>
                <button type="button" id="char1_debil" class="btn btn-primary">🗡️ Ataque Débil</button>
            </div>
        </div>

        <div>
            <h3 id="char2_name" class="mt-3">{{ char2.name }}</h3>
            <p>HP: <span id="char2_hp">100</span></p>
            <input type="hidden" id="char2_id" value="{{ char2.id }}">

            <div id="char2_controls">
                <button type="button" id="char2_fuerte" class="btn btn-primary">⚔️ Ataque Fuerte</button>
                <button type="button" id="char2_debil" class="btn btn-primary">🗡️ Ataque Débil</button>
            </div>
        </div>

        <!-- Campo oculto para almacenar el jugador cuyo turno es -->
        <input type="hidden" id="turn_player" value="{{ turn_player }}">
    </div>
{% endblock %}